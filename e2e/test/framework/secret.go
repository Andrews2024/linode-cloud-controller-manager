package framework

import (
	"context"

	corev1 "k8s.io/api/core/v1"
	metav1 "k8s.io/apimachinery/pkg/apis/meta/v1"
)

const (
	serverCert = `-----BEGIN CERTIFICATE-----
MIIFcjCCA1qgAwIBAgIJAM2X8k3I/mF6MA0GCSqGSIb3DQEBCwUAMFIxCzAJBgNV
BAYTAkFVMRMwEQYDVQQIDApTb21lLVN0YXRlMSEwHwYDVQQKDBhJbnRlcm5ldCBX
aWRnaXRzIFB0eSBMdGQxCzAJBgNVBAMMAmNhMB4XDTIwMTEwOTE3NDU1NFoXDTI0
MTAxOTE3NDU1NFowcjELMAkGA1UEBhMCVVMxCzAJBgNVBAgMAlBBMRUwEwYDVQQH
DAxQaGlsYWRlbHBoaWExEzARBgNVBAoMCkxpbm9kZSBMTEMxFDASBgNVBAsMC0xp
bm9kZSBUZXN0MRQwEgYDVQQDDAtsaW5vZGUudGVzdDCCAiIwDQYJKoZIhvcNAQEB
BQADggIPADCCAgoCggIBANuycV24k/tGqbUrxNrhWpCUH/qsE+ZhhQjWkBUQQ3cc
S01BelMoJWX5U/SnVbSfZJrMmY/b4RZ8bM1p6FCtWP67pzmE3yZTQVadvHzuNx61
LWhxQmZ3L7tAuE3XNPe9tadqT+Z4YF7/AbWXgwFWP4Y0iBoD9dVjS0lj9nmZ+Pqu
Ia+4lKlai0WFc+XuPPW9bBF6Qokg1rquhlkc7xAarh19BfNplvOAzH2tk63BuG8N
ItK+JylnIAd2re7Ed9g7xDxbBYhK3hYDbMe29SnBvp4MwN2Si/W74kCki445+PFT
6Ff8OZU9z2BiAI8LtrWzWPCenVHJ4uGh5yMIcARVW+dvfXiBAp3HLnlRMcPC7VwW
DlCk+APHaCst2QauAflmPDdEIROh/Lbi6wJeiFIfK3brryXN/PkCAw+iCq+fM7nr
LeqtP5Tb467jn1DGvhLAT1+/ecMg7qi+LVMn8kslMmDV3EOIqdpxUwWF6Ae+Yy7F
x1C4TgvuwG8c1njO+po3jYCs1CWs/tRFDC2DkrH4mBTJVn6Ii4pX+1jHUd2yx3HB
QAP0INwmRE1PwdtGpmAyP/tE72NbXdNYM6FMd1IwzwepqZ7YKw6EyEgzQL2YDzrf
Xm7OwBDOv4h4CELQJwkFC080OPIt1mZaT2G9iHljrDQl4jmTzfkk13nS+TNyFMFH
AgMBAAGjKzApMCcGA1UdEQQgMB6CC2xpbm9kZS50ZXN0gg93d3cubGlub2RlLnRl
c3QwDQYJKoZIhvcNAQELBQADggIBAEzwYvkEfTZJYQQTeLGdc9cjnDfhN1qYzgPY
eEYmU0V6bsKEqnJwZWl8vGVoOYY7Coe46lNTWMlYjNk3Of/qRCHiAiblGEUoMG24
79tEaseLE28P4UDzLPQeO+z5JOdVkyKs++Q6o1Or9oQIFdtbRIKXwATEUgJSiMq7
fyoDlWxFWNQ1bTJe6l+0rbZpIHpxbLnIimZUzgrYVlXHnPS2TSSLPo9vbxvvLFTJ
T6CF5fgdxkLq8NVbTHni/YjBMzk4q2D0WaoPO1Oeq+fAts+OrPDZMfXWmp4s7nPw
63cptWnY+5F30xdQFeXOSphyn2MZy6kZE0P4mU9rQaMyzOA2mA3QJTUhm2iB5K6+
kzv9ydXuX2j0X9dapAAKrxJtGuzbkpvmsL3G3x0rfS9TrKhugu5x+EvlsZcx92Xr
rFSF2tokIg+T/Rev3YNdrq0wHLYJTjAvS5+HWhGCNN9gdaGqkpx1g7BWExl8xgeo
nsLWeEMyQfEOrZyEloTmzAW9qN1qilmR2keQpzvS1PuhMnNxh+eBQyRfeOatwyPQ
ofGA0ZvUwXnAQH/+G1MmYOKkxDCKi+5oMvhaNenQjj2KSwftgQUhSeCV9aAQu9Fa
WpBrglz+S4SPWetrRGfnrxBznReY507ZSdzzMhZEXb+YPWjLd/bFPIiniD+U4a5Z
7gxpALyz
-----END CERTIFICATE-----`
	serverKey = `-----BEGIN RSA PRIVATE KEY-----
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
-----END RSA PRIVATE KEY-----`
)

func (i *lbInvocation) CreateTLSSecret(secretName string) (err error) {
	secret := &corev1.Secret{
		ObjectMeta: metav1.ObjectMeta{
			Name: secretName,
		},
		Data: map[string][]byte{
			corev1.TLSCertKey:       []byte(serverCert),
			corev1.TLSPrivateKeyKey: []byte(serverKey),
		},
		Type: corev1.SecretTypeTLS,
	}

	_, err = i.kubeClient.CoreV1().Secrets(i.Namespace()).Create(context.TODO(), secret, metav1.CreateOptions{})

	return err
}

func (i *lbInvocation) DeleteSecret(name string) error {
	err := i.kubeClient.CoreV1().Secrets(i.Namespace()).Delete(context.TODO(), name, metav1.DeleteOptions{})
	return err
}
